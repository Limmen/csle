<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>csle_cluster.cluster_manager.cluster_manager &mdash; csle-cluster 0.7.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> csle-cluster
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../csle_cluster.constants.html">csle_cluster.constants package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../csle_cluster.cluster_manager.html">csle_cluster.cluster_manager package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">csle-cluster</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>csle_cluster.cluster_manager.cluster_manager</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for csle_cluster.cluster_manager.cluster_manager</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">concurrent</span> <span class="kn">import</span> <span class="n">futures</span>
<span class="kn">import</span> <span class="nn">grpc</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">csle_collector.constants.constants</span> <span class="k">as</span> <span class="nn">collector_constants</span>
<span class="kn">from</span> <span class="nn">csle_common.dao.emulation_config.config</span> <span class="kn">import</span> <span class="n">Config</span>
<span class="kn">import</span> <span class="nn">csle_common.constants.constants</span> <span class="k">as</span> <span class="nn">constants</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.management_system_controller</span> <span class="kn">import</span> <span class="n">ManagementSystemController</span>
<span class="kn">from</span> <span class="nn">csle_common.util.general_util</span> <span class="kn">import</span> <span class="n">GeneralUtil</span>
<span class="kn">from</span> <span class="nn">csle_common.util.cluster_util</span> <span class="kn">import</span> <span class="n">ClusterUtil</span>
<span class="kn">from</span> <span class="nn">csle_common.metastore.metastore_facade</span> <span class="kn">import</span> <span class="n">MetastoreFacade</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.emulation_env_controller</span> <span class="kn">import</span> <span class="n">EmulationEnvController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.container_controller</span> <span class="kn">import</span> <span class="n">ContainerController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.sdn_controller_manager</span> <span class="kn">import</span> <span class="n">SDNControllerManager</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.resource_constraints_controller</span> <span class="kn">import</span> <span class="n">ResourceConstraintsController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.users_controller</span> <span class="kn">import</span> <span class="n">UsersController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.vulnerabilities_controller</span> <span class="kn">import</span> <span class="n">VulnerabilitiesController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.flags_controller</span> <span class="kn">import</span> <span class="n">FlagsController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.traffic_controller</span> <span class="kn">import</span> <span class="n">TrafficController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.topology_controller</span> <span class="kn">import</span> <span class="n">TopologyController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.ovs_controller</span> <span class="kn">import</span> <span class="n">OVSController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.snort_ids_controller</span> <span class="kn">import</span> <span class="n">SnortIDSController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.ossec_ids_controller</span> <span class="kn">import</span> <span class="n">OSSECIDSController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.host_controller</span> <span class="kn">import</span> <span class="n">HostController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.elk_controller</span> <span class="kn">import</span> <span class="n">ELKController</span>
<span class="kn">from</span> <span class="nn">csle_common.controllers.kafka_controller</span> <span class="kn">import</span> <span class="n">KafkaController</span>
<span class="kn">from</span> <span class="nn">csle_common.util.read_emulation_statistics_util</span> <span class="kn">import</span> <span class="n">ReadEmulationStatisticsUtil</span>
<span class="kn">import</span> <span class="nn">csle_ryu.constants.constants</span> <span class="k">as</span> <span class="nn">ryu_constants</span>
<span class="kn">import</span> <span class="nn">csle_cluster.cluster_manager.cluster_manager_pb2_grpc</span>
<span class="kn">import</span> <span class="nn">csle_cluster.cluster_manager.cluster_manager_pb2</span>
<span class="kn">from</span> <span class="nn">csle_cluster.cluster_manager.cluster_manager_util</span> <span class="kn">import</span> <span class="n">ClusterManagerUtil</span>
<span class="kn">import</span> <span class="nn">csle_cluster.constants.constants</span> <span class="k">as</span> <span class="nn">cluster_constants</span>


<div class="viewcode-block" id="ClusterManagerServicer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer">[docs]</a><span class="k">class</span> <span class="nc">ClusterManagerServicer</span><span class="p">(</span><span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2_grpc</span><span class="o">.</span><span class="n">ClusterManagerServicer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;gRPC server for managing a node in the CSLE management system cluster&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the server&quot;&quot;&quot;</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="n">collector_constants</span><span class="o">.</span><span class="n">LOG_FILES</span><span class="o">.</span><span class="n">CLUSTER_MANAGER_LOG_FILE</span>
        <span class="nb">dir</span> <span class="o">=</span> <span class="n">collector_constants</span><span class="o">.</span><span class="n">LOG_FILES</span><span class="o">.</span><span class="n">CLUSTER_MANAGER_LOG_DIR</span>
        <span class="n">logfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">logfile</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting up ClusterManager, logfile: </span><span class="si">{</span><span class="n">logfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="ClusterManagerServicer.getNodeStatus"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getNodeStatus">[docs]</a>    <span class="k">def</span> <span class="nf">getNodeStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetNodeStatusMsg</span><span class="p">,</span>
                      <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">NodeStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the status of a node in the CSLE cluster &amp; management system</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of the server</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">ClusterUtil</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">()</span>
        <span class="n">leader</span> <span class="o">=</span> <span class="n">ClusterUtil</span><span class="o">.</span><span class="n">am_i_leader</span><span class="p">(</span><span class="n">ip</span><span class="o">=</span><span class="n">ip</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
        <span class="n">cadvisor_running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_cadvisor_running</span><span class="p">()</span>
        <span class="n">prometheus_running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_prometheus_running</span><span class="p">()</span>
        <span class="n">grafana_running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_grafana_running</span><span class="p">()</span>
        <span class="n">pgadmin_running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_pgadmin_running</span><span class="p">()</span>
        <span class="n">nginx_running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_nginx_running</span><span class="p">()</span>
        <span class="n">flask_running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_flask_running</span><span class="p">()</span>
        <span class="n">postgresql_running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_postgresql_running</span><span class="p">()</span>
        <span class="n">docker_statsmanager_running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_statsmanager_running</span><span class="p">()</span>
        <span class="n">node_exporter_running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_node_exporter_running</span><span class="p">()</span>
        <span class="n">docker_engine_running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_docker_engine_running</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">NodeStatusDTO</span><span class="p">(</span>
            <span class="n">ip</span><span class="o">=</span><span class="n">ip</span><span class="p">,</span> <span class="n">leader</span><span class="o">=</span><span class="n">leader</span><span class="p">,</span> <span class="n">cAdvisorRunning</span><span class="o">=</span><span class="n">cadvisor_running</span><span class="p">,</span> <span class="n">prometheusRunning</span><span class="o">=</span><span class="n">prometheus_running</span><span class="p">,</span>
            <span class="n">grafanaRunning</span><span class="o">=</span><span class="n">grafana_running</span><span class="p">,</span> <span class="n">pgAdminRunning</span><span class="o">=</span><span class="n">pgadmin_running</span><span class="p">,</span> <span class="n">nginxRunning</span><span class="o">=</span><span class="n">nginx_running</span><span class="p">,</span>
            <span class="n">flaskRunning</span><span class="o">=</span><span class="n">flask_running</span><span class="p">,</span> <span class="n">dockerStatsManagerRunning</span><span class="o">=</span><span class="n">docker_statsmanager_running</span><span class="p">,</span>
            <span class="n">nodeExporterRunning</span><span class="o">=</span><span class="n">node_exporter_running</span><span class="p">,</span> <span class="n">postgreSQLRunning</span><span class="o">=</span><span class="n">postgresql_running</span><span class="p">,</span>
            <span class="n">dockerEngineRunning</span><span class="o">=</span><span class="n">docker_engine_running</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startPostgreSQL"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startPostgreSQL">[docs]</a>    <span class="k">def</span> <span class="nf">startPostgreSQL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartPostgreSQLMsg</span><span class="p">,</span>
                        <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts Postgresql</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of PostgreSQL</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting postgresql with command: </span><span class="si">{</span><span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">POSTGRESQL_START</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">operation_status</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">start_postgresql</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Started postgresql, stdout:</span><span class="si">{</span><span class="n">stdout</span><span class="si">}</span><span class="s2">, stderr: </span><span class="si">{</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopPostgreSQL"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopPostgreSQL">[docs]</a>    <span class="k">def</span> <span class="nf">stopPostgreSQL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopPostgreSQLMsg</span><span class="p">,</span>
                       <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops Postgresql</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of PostgreSQL</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping postgresql with command: </span><span class="si">{</span><span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">POSTGRESQL_STOP</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">operation_status</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_postgresql</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopped postgresql, stdout:</span><span class="si">{</span><span class="n">stdout</span><span class="si">}</span><span class="s2">, stderr: </span><span class="si">{</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startDockerEngine"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startDockerEngine">[docs]</a>    <span class="k">def</span> <span class="nf">startDockerEngine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartDockerEngineMsg</span><span class="p">,</span>
                          <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts Docker Engine</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of  the Docker egine</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the docker engine with command: </span><span class="si">{</span><span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">DOCKER_ENGINE_START</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">operation_status</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">start_docker_engine</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Started the docker engine, stdout:</span><span class="si">{</span><span class="n">stdout</span><span class="si">}</span><span class="s2">, stderr: </span><span class="si">{</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopDockerEngine"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopDockerEngine">[docs]</a>    <span class="k">def</span> <span class="nf">stopDockerEngine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopDockerEngineMsg</span><span class="p">,</span>
                         <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Docker Engine</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of the Docker Engine</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Docker engine with command: </span><span class="si">{</span><span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">DOCKER_ENGINE_STOP</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">operation_status</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_docker_engine</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopped the Docker engine, stdout:</span><span class="si">{</span><span class="n">stdout</span><span class="si">}</span><span class="s2">, stderr: </span><span class="si">{</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startNginx"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startNginx">[docs]</a>    <span class="k">def</span> <span class="nf">startNginx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartNginxMsg</span><span class="p">,</span>
                   <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts Nginx</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of Nginx</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting nginx with command: </span><span class="si">{</span><span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">NGINX_START</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">operation_status</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">start_nginx</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Started nginx, stdout:</span><span class="si">{</span><span class="n">stdout</span><span class="si">}</span><span class="s2">, stderr: </span><span class="si">{</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopNginx"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopNginx">[docs]</a>    <span class="k">def</span> <span class="nf">stopNginx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopNginxMsg</span><span class="p">,</span>
                  <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops Nginx</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of Nginx</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping Nginx with command: </span><span class="si">{</span><span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">NGINX_STOP</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">operation_status</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_nginx</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopped Nginx, stdout:</span><span class="si">{</span><span class="n">stdout</span><span class="si">}</span><span class="s2">, stderr: </span><span class="si">{</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startCAdvisor"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startCAdvisor">[docs]</a>    <span class="k">def</span> <span class="nf">startCAdvisor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartCAdvisorMsg</span><span class="p">,</span>
                      <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts cAdvisor</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of cAdvisor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting cAdvisor&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">start_cadvisor</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Started cAdvisor&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopCAdvisor"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopCAdvisor">[docs]</a>    <span class="k">def</span> <span class="nf">stopCAdvisor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopCAdvisorMsg</span><span class="p">,</span>
                     <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops cAdvisor</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of cAdvisor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping cAdvisor&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_cadvisor</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopped cAdvisor&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startNodeExporter"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startNodeExporter">[docs]</a>    <span class="k">def</span> <span class="nf">startNodeExporter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartNodeExporterMsg</span><span class="p">,</span>
                          <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts node exporter</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of node exporter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting node exporter&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">start_node_exporter</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Started node exporter&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopNodeExporter"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopNodeExporter">[docs]</a>    <span class="k">def</span> <span class="nf">stopNodeExporter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopNodeExporterMsg</span><span class="p">,</span>
                         <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops node exporter</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of node exporter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping node exporter&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_node_exporter</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopped node exporter&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startGrafana"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startGrafana">[docs]</a>    <span class="k">def</span> <span class="nf">startGrafana</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartGrafanaMsg</span><span class="p">,</span>
                     <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts grafana</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of grafana</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting grafana&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">start_grafana</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Started grafana&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopGrafana"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopGrafana">[docs]</a>    <span class="k">def</span> <span class="nf">stopGrafana</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopGrafanaMsg</span><span class="p">,</span>
                    <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops grafana</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of grafana</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping grafana&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_grafana</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopped grafana&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startPrometheus"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startPrometheus">[docs]</a>    <span class="k">def</span> <span class="nf">startPrometheus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartPrometheusMsg</span><span class="p">,</span>
                        <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts Prometheus</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of Prometheus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting Prometheus&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">start_prometheus</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Started Prometheus&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopPrometheus"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopPrometheus">[docs]</a>    <span class="k">def</span> <span class="nf">stopPrometheus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopPrometheusMsg</span><span class="p">,</span>
                       <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops Prometheus</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of Prometheus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping Prometheus&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_prometheus</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopped Prometheus&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startPgAdmin"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startPgAdmin">[docs]</a>    <span class="k">def</span> <span class="nf">startPgAdmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartPgAdminMsg</span><span class="p">,</span>
                     <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts pgAdmin</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of pgAdmin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting pgAdmin&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">start_pgadmin</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Started pgAdmin&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopPgAdmin"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopPgAdmin">[docs]</a>    <span class="k">def</span> <span class="nf">stopPgAdmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopPgAdminMsg</span><span class="p">,</span>
                    <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops pgAdmin</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of pgAdmin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping pgAdmin&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_pgadmin</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopped pgAdmin&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startFlask"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startFlask">[docs]</a>    <span class="k">def</span> <span class="nf">startFlask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartFlaskMsg</span><span class="p">,</span>
                   <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts Flask</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of flask</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting flask&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">start_flask</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Started flask&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopFlask"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopFlask">[docs]</a>    <span class="k">def</span> <span class="nf">stopFlask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopFlaskMsg</span><span class="p">,</span>
                  <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops Flask</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of flask</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping flask&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_flask</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopped flask&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startDockerStatsManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startDockerStatsManager">[docs]</a>    <span class="k">def</span> <span class="nf">startDockerStatsManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartDockerStatsManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the docker statsmanager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of the docker statsmanager</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting the docker statsmanager&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">start_docker_statsmanager</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Started the docker statsmanager&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopDockerStatsManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopDockerStatsManager">[docs]</a>    <span class="k">def</span> <span class="nf">stopDockerStatsManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopDockerStatsManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the docker statsmanaager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with the status of the docker statsmanager</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping the Docker statsmanager&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_docker_statsmanager</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopped the Docker statsmanager&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getLogFile"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getLogFile">[docs]</a>    <span class="k">def</span> <span class="nf">getLogFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetLogFileMsg</span><span class="p">,</span>
                   <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets a specific log file</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting log file: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception reading log file: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">. Stacktrace: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getFlaskLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getFlaskLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getFlaskLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetFlaskLogsMsg</span><span class="p">,</span>
                     <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the Flask logs</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the flask logs&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get_current_config</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">flask_log_file</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">logs</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception reading log file: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">. Stacktrace: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getPostrgreSQLLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getPostrgreSQLLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getPostrgreSQLLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetPostgreSQLLogsMsg</span><span class="p">,</span>
                           <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the PostgreSQL logs</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the PostgreSQL logs&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get_current_config</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">postgresql_log_dir</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">and</span> <span class="n">constants</span><span class="o">.</span><span class="n">FILE_PATTERNS</span><span class="o">.</span><span class="n">LOG_SUFFIX</span> <span class="ow">in</span> <span class="n">item</span> <span class="ow">and</span> \
                    <span class="n">constants</span><span class="o">.</span><span class="n">FILE_PATTERNS</span><span class="o">.</span><span class="n">GZ_SUFFIX</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">logs</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception reading log file: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">. Stacktrace: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getDockerLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getDockerLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getDockerLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetDockerLogsMsg</span><span class="p">,</span>
                      <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the Docker logs</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the Docker logs&quot;</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">DOCKER_ENGINE_LOGS</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">(</span><span class="n">output_bytes</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
        <span class="n">output_str</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="n">output</span>
        <span class="k">if</span> <span class="n">logs</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]:</span>
            <span class="n">alt_cmd</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">DOCKER_ENGINE_LOGS_ALTERNATIVE</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">alt_cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="p">(</span><span class="n">output_bytes</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
            <span class="n">output_str</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">output_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span>
            <span class="n">logs</span> <span class="o">=</span> <span class="n">output</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getNginxLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getNginxLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getNginxLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetNginxLogsMsg</span><span class="p">,</span>
                     <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the nginx logs</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the Nginx logs&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get_current_config</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">nginx_log_dir</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">and</span> <span class="n">constants</span><span class="o">.</span><span class="n">FILE_PATTERNS</span><span class="o">.</span><span class="n">LOG_SUFFIX</span> <span class="ow">in</span> <span class="n">item</span> \
                    <span class="ow">and</span> <span class="n">constants</span><span class="o">.</span><span class="n">FILE_PATTERNS</span><span class="o">.</span><span class="n">GZ_SUFFIX</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">logs</span> <span class="o">=</span> <span class="n">logs</span> <span class="o">+</span> <span class="n">data</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception reading log file: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">. Stacktrace: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getGrafanaLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getGrafanaLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getGrafanaLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetGrafanaLogsMsg</span><span class="p">,</span>
                       <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the Grafana logs</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the Grafana logs&quot;</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">GRAFANA_LOGS</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">(</span><span class="n">output_bytes</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
        <span class="n">output_str</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="n">output</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getPgAdminLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getPgAdminLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getPgAdminLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetPgAdminLogsMsg</span><span class="p">,</span>
                       <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the pgAdmin logs</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the pgAdmin logs&quot;</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">PGADMIN_LOGS</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">(</span><span class="n">output_bytes</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
        <span class="n">output_str</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="n">output</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getCadvisorLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getCadvisorLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getCadvisorLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetCAdvisorLogsMsg</span><span class="p">,</span>
                        <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the cAdvisor logs</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the cAdvisor logs&quot;</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">CADVISOR_LOGS</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">(</span><span class="n">output_bytes</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
        <span class="n">output_str</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="n">output</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getNodeExporterLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getNodeExporterLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getNodeExporterLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetNodeExporterLogsMsg</span><span class="p">,</span>
                            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the node exporter logs</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the Node exporter logs&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get_current_config</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">node_exporter_log_file</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">logs</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception reading log file: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">. Stacktrace: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getPrometheusLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getPrometheusLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getPrometheusLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetPrometheusLogsMsg</span><span class="p">,</span>
                          <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the Prometheus logs</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the Prometheus logs&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get_current_config</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">prometheus_log_file</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">logs</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception reading log file: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">. Stacktrace: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getDockerStatsManagerLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getDockerStatsManagerLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getDockerStatsManagerLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetDockerStatsManagerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the Docker statsmanager logs</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the Docker statsmanager logs&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get_current_config</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">docker_stats_manager_log_dir</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">docker_stats_manager_log_file</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">logs</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception reading log file: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">. Stacktrace: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getCsleLogFiles"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getCsleLogFiles">[docs]</a>    <span class="k">def</span> <span class="nf">getCsleLogFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetCsleLogFilesMsg</span><span class="p">,</span>
                        <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the list of file names in the CSLE log directory</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the CSLE log file names&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get_current_config</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">default_log_dir</span>
        <span class="n">log_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="n">log_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_files</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="n">log_files</span> <span class="o">=</span> <span class="n">log_files</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">log_files</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startContainersInExecution"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startContainersInExecution">[docs]</a>    <span class="k">def</span> <span class="nf">startContainersInExecution</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartContainersInExecutionMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the containers of a given emulation execution that are configured to be deployed on this host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting containers in execution with ID: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">run_containers</span><span class="p">(</span><span class="n">emulation_execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                                              <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">update_emulation_execution</span><span class="p">(</span><span class="n">emulation_execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                                                   <span class="n">ip_first_octet</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">ip_first_octet</span><span class="p">,</span>
                                                   <span class="n">emulation</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.attachContainersInExecutionToNetworks"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.attachContainersInExecutionToNetworks">[docs]</a>    <span class="k">def</span> <span class="nf">attachContainersInExecutionToNetworks</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartContainersInExecutionMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Attaches the containers of a given emulation execution that are configured to be deployed on this host to</span>
<span class="sd">        their corresponding virtual overlay networks</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attaching containers in execution with ID: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2"> to networks&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ContainerController</span><span class="o">.</span><span class="n">connect_containers_to_networks</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                           <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                           <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">update_emulation_execution</span><span class="p">(</span><span class="n">emulation_execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                                                   <span class="n">ip_first_octet</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">ip_first_octet</span><span class="p">,</span>
                                                   <span class="n">emulation</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.installLibraries"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.installLibraries">[docs]</a>    <span class="k">def</span> <span class="nf">installLibraries</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">InstallLibrariesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Installs CSLE libraries on containers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Install CSLE libraries on containers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">install_csle_collector_and_ryu_libraries</span><span class="p">(</span>
            <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
            <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.applyKafkaConfig"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.applyKafkaConfig">[docs]</a>    <span class="k">def</span> <span class="nf">applyKafkaConfig</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ApplyKafkaConfigMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the Kafka configuration to an execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies the Kafka configuration on containers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">apply_kafka_config</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                  <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                  <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSdnController"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSdnController">[docs]</a>    <span class="k">def</span> <span class="nf">startSdnController</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSdnControllerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Ryu SDN controller of an execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the Ryu SDN controller in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">SDNControllerManager</span><span class="o">.</span><span class="n">start_ryu</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                       <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                       <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.applyResourceConstraints"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.applyResourceConstraints">[docs]</a>    <span class="k">def</span> <span class="nf">applyResourceConstraints</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ApplyResouceConstraintsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies resource constraints to containers in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies resource constraints to containers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ResourceConstraintsController</span><span class="o">.</span><span class="n">apply_resource_constraints</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                                 <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                                 <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.createOvsSwitches"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.createOvsSwitches">[docs]</a>    <span class="k">def</span> <span class="nf">createOvsSwitches</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CreateOvsSwitchesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates OVS switches in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating OVS switches in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">OVSController</span><span class="o">.</span><span class="n">create_virtual_switches_on_container</span><span class="p">(</span>
            <span class="n">containers_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">containers_config</span><span class="p">,</span>
            <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.pingExecution"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.pingExecution">[docs]</a>    <span class="k">def</span> <span class="nf">pingExecution</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">PingExecutionMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pings all containers in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pinging containers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">ping_all</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                        <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                        <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.configureOvs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.configureOvs">[docs]</a>    <span class="k">def</span> <span class="nf">configureOvs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ConfigureOvsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures OVS switches in an execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuring OVS switches in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2">, applying the configuration&quot;</span><span class="p">)</span>
        <span class="n">OVSController</span><span class="o">.</span><span class="n">apply_ovs_config</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                       <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSdnControllerMonitor"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSdnControllerMonitor">[docs]</a>    <span class="k">def</span> <span class="nf">startSdnControllerMonitor</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSdnControllerMonitorMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the SDN controller monitor in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the SDN controller monitor in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">SDNControllerManager</span><span class="o">.</span><span class="n">start_ryu_monitor</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                               <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                               <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.createUsers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.createUsers">[docs]</a>    <span class="k">def</span> <span class="nf">createUsers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CreateUsersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates users in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creates users in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">UsersController</span><span class="o">.</span><span class="n">create_users</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                     <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                     <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.createVulnerabilities"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.createVulnerabilities">[docs]</a>    <span class="k">def</span> <span class="nf">createVulnerabilities</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CreateVulnsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates vulnerabilities in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creates vulnerabilities in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">VulnerabilitiesController</span><span class="o">.</span><span class="n">create_vulns</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                               <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                               <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.createFlags"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.createFlags">[docs]</a>    <span class="k">def</span> <span class="nf">createFlags</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CreateFlagsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates flags in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creates flags in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">FlagsController</span><span class="o">.</span><span class="n">create_flags</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                     <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                     <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.createTopology"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.createTopology">[docs]</a>    <span class="k">def</span> <span class="nf">createTopology</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CreateTopologyMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures the topology of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configures the topology in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">TopologyController</span><span class="o">.</span><span class="n">create_topology</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                           <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                           <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startTrafficManagers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startTrafficManagers">[docs]</a>    <span class="k">def</span> <span class="nf">startTrafficManagers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartTrafficManagersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts traffic managers in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts traffic managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">TrafficController</span><span class="o">.</span><span class="n">start_traffic_managers</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                 <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                 <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startTrafficGenerators"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startTrafficGenerators">[docs]</a>    <span class="k">def</span> <span class="nf">startTrafficGenerators</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartTrafficGeneratorsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts traffic generators in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts traffic generators in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">TrafficController</span><span class="o">.</span><span class="n">start_internal_traffic_generators</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                            <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                            <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startClientPopulation"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startClientPopulation">[docs]</a>    <span class="k">def</span> <span class="nf">startClientPopulation</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartClientPopulationMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the client population of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the client population in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">TrafficController</span><span class="o">.</span><span class="n">start_client_population</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                  <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                  <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startKafkaClientProducer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startKafkaClientProducer">[docs]</a>    <span class="k">def</span> <span class="nf">startKafkaClientProducer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartKafkaClientProducerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Kafka client producer of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the Kafka client producer in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">TrafficController</span><span class="o">.</span><span class="n">start_client_producer</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopKafkaClientProducer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopKafkaClientProducer">[docs]</a>    <span class="k">def</span> <span class="nf">stopKafkaClientProducer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopKafkaClientProducerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Kafka client producer of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stops the Kafka client producer in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">TrafficController</span><span class="o">.</span><span class="n">stop_client_producer</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                               <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                               <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSnortIdses"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSnortIdses">[docs]</a>    <span class="k">def</span> <span class="nf">startSnortIdses</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSnortIdsesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Snort IDSes in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the Snort IDSes in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">start_snort_idses</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                             <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                             <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSnortIdsesMonitorThreads"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSnortIdsesMonitorThreads">[docs]</a>    <span class="k">def</span> <span class="nf">startSnortIdsesMonitorThreads</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSnortIdsesMonitorThreadsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Snort IDSes monitor threads in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the Snort IDSes monitor threads in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">start_snort_idses_monitor_threads</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                             <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                             <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startOssecIdses"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startOssecIdses">[docs]</a>    <span class="k">def</span> <span class="nf">startOssecIdses</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartOSSECIdsesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the OSSEC IDSes in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the OSSEC IDSes in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">start_ossec_idses</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                             <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                             <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startOssecIdsesMonitorThreads"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startOssecIdsesMonitorThreads">[docs]</a>    <span class="k">def</span> <span class="nf">startOssecIdsesMonitorThreads</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartOSSECIdsesMonitorThreadsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the OSSEC IDSes monitor threads in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the OSSEC IDSes monitor threads in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">start_ossec_idses_monitor_threads</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                             <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                             <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startElkStack"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startElkStack">[docs]</a>    <span class="k">def</span> <span class="nf">startElkStack</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartElkStackMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the ELK stack in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the ELK stack in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ELKController</span><span class="o">.</span><span class="n">start_elk_stack</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                      <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                      <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startHostManagers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startHostManagers">[docs]</a>    <span class="k">def</span> <span class="nf">startHostManagers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartHostManagersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the host managers of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the host managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">start_host_monitor_threads</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                  <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                  <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.applyFileBeatsConfig"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.applyFileBeatsConfig">[docs]</a>    <span class="k">def</span> <span class="nf">applyFileBeatsConfig</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ApplyFileBeatConfigsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the filebeat configurations to a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies filebeat configurations to containers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">config_filebeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                        <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                        <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.applyPacketBeatsConfig"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.applyPacketBeatsConfig">[docs]</a>    <span class="k">def</span> <span class="nf">applyPacketBeatsConfig</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ApplyPacketBeatConfigsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the packetbeat configurations to a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies the packetbeat configurations in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">config_packetbeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                          <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                          <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.applyMetricBeatsConfig"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.applyMetricBeatsConfig">[docs]</a>    <span class="k">def</span> <span class="nf">applyMetricBeatsConfig</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ApplyMetricBeatConfigsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the metricbeat configurations to a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies the metricbeat configurations in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">config_metricbeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                          <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                          <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.applyHeartBeatsConfig"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.applyHeartBeatsConfig">[docs]</a>    <span class="k">def</span> <span class="nf">applyHeartBeatsConfig</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ApplyHeartBeatConfigsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the heartbeat configurations to a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies the heartbeat configurations in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">config_heartbeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                         <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                         <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startFilebeats"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startFilebeats">[docs]</a>    <span class="k">def</span> <span class="nf">startFilebeats</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartFileBeatsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts filebeats in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting filebeats in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">start_filebeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                       <span class="n">initial_start</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="p">,</span>
                                       <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                       <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startPacketbeats"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startPacketbeats">[docs]</a>    <span class="k">def</span> <span class="nf">startPacketbeats</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartPacketBeatsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts packetbetas in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting packetbeats in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">start_packetbeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                         <span class="n">initial_start</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="p">,</span>
                                         <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                         <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startMetricbeats"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startMetricbeats">[docs]</a>    <span class="k">def</span> <span class="nf">startMetricbeats</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartMetricBeatsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts metricbeats in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting metricbeats in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">start_metricbeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                         <span class="n">initial_start</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="p">,</span>
                                         <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                         <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startHeartbeats"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startHeartbeats">[docs]</a>    <span class="k">def</span> <span class="nf">startHeartbeats</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartHeartBeatsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts heartbeats in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting heartbeats in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">start_heartbeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                        <span class="n">initial_start</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="p">,</span>
                                        <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                        <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startDockerStatsManagerThread"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startDockerStatsManagerThread">[docs]</a>    <span class="k">def</span> <span class="nf">startDockerStatsManagerThread</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartDockerStatsManagerThreadMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the docker stats manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting docker stats manager thread for execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ContainerController</span><span class="o">.</span><span class="n">start_docker_stats_thread</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                                                      <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                      <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ServiceStatusDTO</span><span class="p">(</span><span class="n">running</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopAllExecutionsOfEmulation"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopAllExecutionsOfEmulation">[docs]</a>    <span class="k">def</span> <span class="nf">stopAllExecutionsOfEmulation</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopAllExecutionsOfEmulationMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops all executions of a given emulation</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping executions of emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">emulation</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_by_name</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">emulation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">stop_all_executions_of_emulation</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">emulation</span><span class="p">,</span>
                                                                <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                                <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopExecution"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopExecution">[docs]</a>    <span class="k">def</span> <span class="nf">stopExecution</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopExecutionMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">stop_execution_of_emulation</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                           <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                           <span class="n">execution_id</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">ip_first_octet</span><span class="p">,</span>
                                                           <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopAllExecutions"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopAllExecutions">[docs]</a>    <span class="k">def</span> <span class="nf">stopAllExecutions</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopAllExecutionsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops all executions</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping all executions&quot;</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">stop_all_executions</span><span class="p">(</span><span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                   <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.cleanAllExecutions"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.cleanAllExecutions">[docs]</a>    <span class="k">def</span> <span class="nf">cleanAllExecutions</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CleanAllExecutionsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cleans all executions</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Cleaning all executions&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">leader</span> <span class="o">=</span> <span class="n">ClusterUtil</span><span class="o">.</span><span class="n">am_i_leader</span><span class="p">(</span><span class="n">ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">clean_all_executions</span><span class="p">(</span><span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                    <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span> <span class="n">leader</span><span class="o">=</span><span class="n">leader</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.cleanAllExecutionsOfEmulation"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.cleanAllExecutionsOfEmulation">[docs]</a>    <span class="k">def</span> <span class="nf">cleanAllExecutionsOfEmulation</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CleanAllExecutionsOfEmulationMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cleans all executions of a given emulation</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cleaning executions of emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">emulation</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_by_name</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">emulation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">leader</span> <span class="o">=</span> <span class="n">ClusterUtil</span><span class="o">.</span><span class="n">am_i_leader</span><span class="p">(</span><span class="n">ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">clean_all_emulation_executions</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">emulation</span><span class="p">,</span>
                                                              <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                              <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span> <span class="n">leader</span><span class="o">=</span><span class="n">leader</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.cleanExecution"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.cleanExecution">[docs]</a>    <span class="k">def</span> <span class="nf">cleanExecution</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CleanExecutionMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cleans a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cleaning execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">leader</span> <span class="o">=</span> <span class="n">ClusterUtil</span><span class="o">.</span><span class="n">am_i_leader</span><span class="p">(</span><span class="n">ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">clean_emulation_execution</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                         <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                         <span class="n">execution_id</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">ip_first_octet</span><span class="p">,</span>
                                                         <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span> <span class="n">leader</span><span class="o">=</span><span class="n">leader</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startTrafficManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startTrafficManager">[docs]</a>    <span class="k">def</span> <span class="nf">startTrafficManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartTrafficManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts a specific traffic manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting traffic manager with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">node_traffic_config</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">get_node_traffic_config_by_ip</span><span class="p">(</span>
            <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">node_traffic_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">node_traffic_config</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">TrafficController</span><span class="o">.</span><span class="n">start_traffic_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                    <span class="n">node_traffic_config</span><span class="o">=</span><span class="n">node_traffic_config</span><span class="p">,</span>
                                                    <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopTrafficManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopTrafficManager">[docs]</a>    <span class="k">def</span> <span class="nf">stopTrafficManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopTrafficManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops a specific traffic manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping traffic manager with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">node_traffic_config</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">get_node_traffic_config_by_ip</span><span class="p">(</span>
            <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">node_traffic_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">node_traffic_config</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">TrafficController</span><span class="o">.</span><span class="n">stop_traffic_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                   <span class="n">node_traffic_config</span><span class="o">=</span><span class="n">node_traffic_config</span><span class="p">,</span>
                                                   <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopTrafficManagers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopTrafficManagers">[docs]</a>    <span class="k">def</span> <span class="nf">stopTrafficManagers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopTrafficManagersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops traffic managers in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stops traffic managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">TrafficController</span><span class="o">.</span><span class="n">stop_traffic_managers</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startClientManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startClientManager">[docs]</a>    <span class="k">def</span> <span class="nf">startClientManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartClientManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the client manager of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the client manager in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">client_population_config</span><span class="o">.</span><span class="n">physical_host_ip</span> \
                <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">TrafficController</span><span class="o">.</span><span class="n">start_client_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                   <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopClientManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopClientManager">[docs]</a>    <span class="k">def</span> <span class="nf">stopClientManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopClientManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the client manager of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stops the client manager in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">client_population_config</span><span class="o">.</span><span class="n">physical_host_ip</span> \
                <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">TrafficController</span><span class="o">.</span><span class="n">stop_client_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                  <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopClientPopulation"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopClientPopulation">[docs]</a>    <span class="k">def</span> <span class="nf">stopClientPopulation</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopClientPopulationMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the client population of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stops the client population in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">client_population_config</span><span class="o">.</span><span class="n">physical_host_ip</span> \
                <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">TrafficController</span><span class="o">.</span><span class="n">stop_client_population</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                     <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getNumActiveClients"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getNumActiveClients">[docs]</a>    <span class="k">def</span> <span class="nf">getNumActiveClients</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetNumActiveClientsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetNumClientsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the number of active clients of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a GetNumActiveClientsMsg</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the number of active clients in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> \
                <span class="ow">and</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">client_population_config</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> \
                <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">clients_dto</span> <span class="o">=</span> <span class="n">TrafficController</span><span class="o">.</span><span class="n">get_num_active_clients</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                                   <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_client_dto_to_get_num_clients_dto</span><span class="p">(</span><span class="n">clients_dto</span><span class="o">=</span><span class="n">clients_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
   
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_get_num_clients_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopTrafficGenerators"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopTrafficGenerators">[docs]</a>    <span class="k">def</span> <span class="nf">stopTrafficGenerators</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopTrafficGeneratorsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops traffic generators in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stops traffic generators in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">TrafficController</span><span class="o">.</span><span class="n">stop_internal_traffic_generators</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                           <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                           <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startTrafficGenerator"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startTrafficGenerator">[docs]</a>    <span class="k">def</span> <span class="nf">startTrafficGenerator</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartTrafficGeneratorMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts a specific traffic generator</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting traffic generator with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">node_traffic_config</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">get_node_traffic_config_by_ip</span><span class="p">(</span>
            <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="n">node_container_config</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">containers_config</span><span class="o">.</span><span class="n">get_container_from_ip</span><span class="p">(</span>
            <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">node_traffic_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">node_traffic_config</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">TrafficController</span><span class="o">.</span><span class="n">start_internal_traffic_generator</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                               <span class="n">node_traffic_config</span><span class="o">=</span><span class="n">node_traffic_config</span><span class="p">,</span>
                                                               <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                                                               <span class="n">container</span><span class="o">=</span><span class="n">node_container_config</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopTrafficGenerator"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopTrafficGenerator">[docs]</a>    <span class="k">def</span> <span class="nf">stopTrafficGenerator</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopTrafficGeneratorMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops a specific traffic generator</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping traffic generator with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">node_traffic_config</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">get_node_traffic_config_by_ip</span><span class="p">(</span>
            <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">node_traffic_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">node_traffic_config</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">TrafficController</span><span class="o">.</span><span class="n">stop_internal_traffic_generator</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                              <span class="n">node_traffic_config</span><span class="o">=</span><span class="n">node_traffic_config</span><span class="p">,</span>
                                                              <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getClientManagersInfo"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getClientManagersInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getClientManagersInfo</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetClientManagersInfoMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ClientManagersInfoDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the info of client managers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a ClientManagersInfoDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the info of client managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">client_population_config</span><span class="o">.</span><span class="n">physical_host_ip</span> \
                <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>

            <span class="n">client_managers_dto</span> <span class="o">=</span> <span class="n">TrafficController</span><span class="o">.</span><span class="n">get_client_managers_info</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                <span class="n">active_ips</span><span class="o">=</span><span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_active_ips</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_client_info_dto</span><span class="p">(</span><span class="n">client_managers_dto</span><span class="o">=</span><span class="n">client_managers_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_client_managers_info_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getTrafficManagersInfo"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getTrafficManagersInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getTrafficManagersInfo</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetTrafficManagersInfoMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">TrafficManagersInfoDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the info of traffic managers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a TrafficManagersInfoDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the info of traffic managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">traffic_managers_dto</span> <span class="o">=</span> <span class="n">TrafficController</span><span class="o">.</span><span class="n">get_traffic_managers_info</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                <span class="n">active_ips</span><span class="o">=</span><span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_active_ips</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">),</span>
                <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_traffic_info_dto</span><span class="p">(</span><span class="n">traffic_managers_dto</span><span class="o">=</span><span class="n">traffic_managers_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_traffic_managers_info_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopAllRunningContainers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopAllRunningContainers">[docs]</a>    <span class="k">def</span> <span class="nf">stopAllRunningContainers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopAllRunningContainersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops all running CSLE containers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping all running CSLE containers&quot;</span><span class="p">)</span>
        <span class="n">ContainerController</span><span class="o">.</span><span class="n">stop_all_running_containers</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopContainer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopContainer">[docs]</a>    <span class="k">def</span> <span class="nf">stopContainer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopContainerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops a specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">stop_container</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">outcome</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping container: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.removeAllStoppedContainers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.removeAllStoppedContainers">[docs]</a>    <span class="k">def</span> <span class="nf">removeAllStoppedContainers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RemoveAllStoppedContainersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes all stopped containers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Removing all stopped containers&quot;</span><span class="p">)</span>
        <span class="n">ContainerController</span><span class="o">.</span><span class="n">rm_all_stopped_containers</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.removeContainer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.removeContainer">[docs]</a>    <span class="k">def</span> <span class="nf">removeContainer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RemoveContainerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes all specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">rm_container</span><span class="p">(</span><span class="n">container_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">outcome</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing container: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.removeAllContainerImages"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.removeAllContainerImages">[docs]</a>    <span class="k">def</span> <span class="nf">removeAllContainerImages</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RemoveAllContainerImagesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes all CSLE container images</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Removing all container images&quot;</span><span class="p">)</span>
        <span class="n">ContainerController</span><span class="o">.</span><span class="n">rm_all_images</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.removeContainerImage"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.removeContainerImage">[docs]</a>    <span class="k">def</span> <span class="nf">removeContainerImage</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RemoveContainerImageMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes a specific container image</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">rm_image</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">outcome</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing container image: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.listAllContainerImages"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.listAllContainerImages">[docs]</a>    <span class="k">def</span> <span class="nf">listAllContainerImages</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ListAllContainerImagesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ContainerImagesDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes a specific container image</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a ContainerImagesDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Listing all container images&quot;</span><span class="p">)</span>
        <span class="n">imgs_infos</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">list_all_images</span><span class="p">()</span>
        <span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">img_info</span> <span class="ow">in</span> <span class="n">imgs_infos</span><span class="p">:</span>
            <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ContainerImageDTO</span><span class="p">(</span>
                    <span class="n">repoTags</span><span class="o">=</span><span class="n">img_info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">created</span><span class="o">=</span><span class="n">img_info</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">os</span><span class="o">=</span><span class="n">img_info</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">architecture</span><span class="o">=</span><span class="n">img_info</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">img_info</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ContainerImagesDTO</span><span class="p">(</span><span class="n">images</span><span class="o">=</span><span class="n">images</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.listAllDockerNetworks"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.listAllDockerNetworks">[docs]</a>    <span class="k">def</span> <span class="nf">listAllDockerNetworks</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ListAllDockerNetworksMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">DockerNetworksDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists all docker networks</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DockerNetworksDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Listing all docker networks&quot;</span><span class="p">)</span>
        <span class="n">networks</span><span class="p">,</span> <span class="n">network_ids</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">list_docker_networks</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">DockerNetworksDTO</span><span class="p">(</span>
            <span class="n">networks</span><span class="o">=</span><span class="n">networks</span><span class="p">,</span> <span class="n">network_ids</span><span class="o">=</span><span class="n">network_ids</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startAllStoppedContainers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startAllStoppedContainers">[docs]</a>    <span class="k">def</span> <span class="nf">startAllStoppedContainers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartAllStoppedContainersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts all stopped containers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting all stopped CSLE containers&quot;</span><span class="p">)</span>
        <span class="n">ContainerController</span><span class="o">.</span><span class="n">start_all_stopped_containers</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startContainer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startContainer">[docs]</a>    <span class="k">def</span> <span class="nf">startContainer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartContainerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts a specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">start_container</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">outcome</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the container: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.listAllRunningContainers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.listAllRunningContainers">[docs]</a>    <span class="k">def</span> <span class="nf">listAllRunningContainers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ListAllRunningContainersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RunningContainersDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists all running containers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a RunningContainersDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Listing all running containers&quot;</span><span class="p">)</span>
        <span class="n">running_container_infos</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">list_all_running_containers</span><span class="p">()</span>
        <span class="n">running_containers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rci</span> <span class="ow">in</span> <span class="n">running_container_infos</span><span class="p">:</span>
            <span class="n">running_containers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">DockerContainerDTO</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">rci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image</span><span class="o">=</span><span class="n">rci</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ip</span><span class="o">=</span><span class="n">rci</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RunningContainersDTO</span><span class="p">(</span>
            <span class="n">runningContainers</span><span class="o">=</span><span class="n">running_containers</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.listAllRunningEmulations"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.listAllRunningEmulations">[docs]</a>    <span class="k">def</span> <span class="nf">listAllRunningEmulations</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ListAllRunningEmulationsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RunningEmulationsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists all running emulations</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a RunningEmulationsDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Listing all running emulations&quot;</span><span class="p">)</span>
        <span class="n">running_emulations</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">list_running_emulations</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RunningEmulationsDTO</span><span class="p">(</span>
            <span class="n">runningEmulations</span><span class="o">=</span><span class="n">running_emulations</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.listAllStoppedContainers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.listAllStoppedContainers">[docs]</a>    <span class="k">def</span> <span class="nf">listAllStoppedContainers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ListAllStoppedContainersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StoppedContainersDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists all stopped containers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a StoppedContainersDTOb</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Listing all stopped containers&quot;</span><span class="p">)</span>
        <span class="n">stopped_container_infos</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">list_all_stopped_containers</span><span class="p">()</span>
        <span class="n">stopped_containers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rci</span> <span class="ow">in</span> <span class="n">stopped_container_infos</span><span class="p">:</span>
            <span class="n">stopped_containers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">DockerContainerDTO</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">rci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image</span><span class="o">=</span><span class="n">rci</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ip</span><span class="o">=</span><span class="n">rci</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StoppedContainersDTO</span><span class="p">(</span>
            <span class="n">stoppedContainers</span><span class="o">=</span><span class="n">stopped_containers</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.createEmulationNetworks"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.createEmulationNetworks">[docs]</a>    <span class="k">def</span> <span class="nf">createEmulationNetworks</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CreateEmulationNetworksMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates networks for a given emulation execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating networks for emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2"> and execution id:</span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">leader</span> <span class="o">=</span> <span class="n">ClusterUtil</span><span class="o">.</span><span class="n">am_i_leader</span><span class="p">(</span><span class="n">ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">leader</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not leader, skipping creating networks&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ContainerController</span><span class="o">.</span><span class="n">create_networks</span><span class="p">(</span><span class="n">containers_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">containers_config</span><span class="p">,</span>
                                            <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopDockerStatsManagerThread"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopDockerStatsManagerThread">[docs]</a>    <span class="k">def</span> <span class="nf">stopDockerStatsManagerThread</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopDockerStatsManagerThreadMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the docker stats manager thread</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the docker stats manager thread for execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ContainerController</span><span class="o">.</span><span class="n">stop_docker_stats_thread</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                                                     <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                     <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getDockerStatsManagerStatus"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getDockerStatsManagerStatus">[docs]</a>    <span class="k">def</span> <span class="nf">getDockerStatsManagerStatus</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetDockerStatsManagerStatusMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">DockerStatsMonitorStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the docker stats manager status</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DockerStatsMonitorStatusDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the docker stats manager status by sending a request on port: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">docker_stats_monitor_dto</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">get_docker_stats_manager_status_by_ip_and_port</span><span class="p">(</span>
            <span class="n">ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span> <span class="n">port</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
        <span class="n">dto</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_docker_stats_monitor_dto</span><span class="p">(</span><span class="n">monitor_dto</span><span class="o">=</span><span class="n">docker_stats_monitor_dto</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dto</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.removeDockerNetworks"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.removeDockerNetworks">[docs]</a>    <span class="k">def</span> <span class="nf">removeDockerNetworks</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RemoveDockerNetworksMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes a list of docker networks</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">remove_networks</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">networks</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">outcome</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing docker networks: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">networks</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.removeAllDockerNetworks"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.removeAllDockerNetworks">[docs]</a>    <span class="k">def</span> <span class="nf">removeAllDockerNetworks</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RemoveAllDockerNetworksMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes all docker networks related to CSLE</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Removing all docker networks&quot;</span><span class="p">)</span>
        <span class="n">ContainerController</span><span class="o">.</span><span class="n">rm_all_networks</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getDockerStatsManagersInfo"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getDockerStatsManagersInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getDockerStatsManagersInfo</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetDockerStatsManagersInfoMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> \
            <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">DockerStatsManagersInfoDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the info of docker stats maangers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DockerStatsManagersInfoDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the info of docker stats managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">docker_stats_managers_dto</span> <span class="o">=</span> <span class="n">ContainerController</span><span class="o">.</span><span class="n">get_docker_stats_managers_info</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                <span class="n">active_ips</span><span class="o">=</span><span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_active_ips</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">),</span>
                <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_docker_info_dto</span><span class="p">(</span><span class="n">docker_stats_managers_dto</span><span class="o">=</span><span class="n">docker_stats_managers_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_docker_managers_info_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopElkManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopElkManager">[docs]</a>    <span class="k">def</span> <span class="nf">stopElkManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopElkManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops a specific elk manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping elk manager &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">ELKController</span><span class="o">.</span><span class="n">stop_elk_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                           <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startElkManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startElkManager">[docs]</a>    <span class="k">def</span> <span class="nf">startElkManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartElkManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts a specific elk manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting elk manager &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">ELKController</span><span class="o">.</span><span class="n">start_elk_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                            <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getElkStatus"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getElkStatus">[docs]</a>    <span class="k">def</span> <span class="nf">getElkStatus</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetElkStackStatusMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ElkStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the status of the Elk stack  for a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an ElkStatusDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the status of the elk stack &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">elk_dto</span> <span class="o">=</span> <span class="n">ELKController</span><span class="o">.</span><span class="n">get_elk_status</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                   <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_elk_dto</span><span class="p">(</span><span class="n">elk_dto</span><span class="o">=</span><span class="n">elk_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ElkStatusDTO</span><span class="p">(</span>
                <span class="n">kibanaRunning</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">elasticRunning</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">logstashRunning</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopElkStack"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopElkStack">[docs]</a>    <span class="k">def</span> <span class="nf">stopElkStack</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopElkStackMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the elk stack of a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the ELK stack &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">ELKController</span><span class="o">.</span><span class="n">stop_elk_stack</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                         <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startElastic"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startElastic">[docs]</a>    <span class="k">def</span> <span class="nf">startElastic</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartElasticServiceMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts elastic in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting elastic &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">ELKController</span><span class="o">.</span><span class="n">start_elastic</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                        <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopElastic"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopElastic">[docs]</a>    <span class="k">def</span> <span class="nf">stopElastic</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopElasticServiceMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops elastic in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping elastic &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">ELKController</span><span class="o">.</span><span class="n">stop_elastic</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                       <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startKibana"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startKibana">[docs]</a>    <span class="k">def</span> <span class="nf">startKibana</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartKibanaServiceMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts Kibana in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting KIbana &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">ELKController</span><span class="o">.</span><span class="n">start_kibana</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                       <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopKibana"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopKibana">[docs]</a>    <span class="k">def</span> <span class="nf">stopKibana</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopKibanaServiceMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops Kibana in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping Kibana &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">ELKController</span><span class="o">.</span><span class="n">stop_kibana</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                      <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startLogstash"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startLogstash">[docs]</a>    <span class="k">def</span> <span class="nf">startLogstash</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartLogstashServiceMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts Logstash in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting logstash &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">ELKController</span><span class="o">.</span><span class="n">start_logstash</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                         <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopLogstash"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopLogstash">[docs]</a>    <span class="k">def</span> <span class="nf">stopLogstash</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopLogstashServiceMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops Logstash in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stops logstash &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">ELKController</span><span class="o">.</span><span class="n">stop_logstash</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                        <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getElkManagersInfo"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getElkManagersInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getElkManagersInfo</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetElkManagersInfoMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ElkManagersInfoDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the info of elk managers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a ElkManagersInfoDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the info of elk managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">elk_managers_dto</span> <span class="o">=</span> <span class="n">ELKController</span><span class="o">.</span><span class="n">get_elk_managers_info</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                <span class="n">active_ips</span><span class="o">=</span><span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_active_ips</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">),</span>
                <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_elk_info_dto</span><span class="p">(</span><span class="n">elk_managers_dto</span><span class="o">=</span><span class="n">elk_managers_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_elk_managers_info_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startContainersOfExecution"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startContainersOfExecution">[docs]</a>    <span class="k">def</span> <span class="nf">startContainersOfExecution</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartContainersOfExecutionMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the containers of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts containers &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">start_containers_of_execution</span><span class="p">(</span><span class="n">emulation_execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                                                             <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.runContainer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.runContainer">[docs]</a>    <span class="k">def</span> <span class="nf">runContainer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RunContainerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs a specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running container with image: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">image</span><span class="si">}</span><span class="s2">, name: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, memory: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">memory</span><span class="si">}</span><span class="s2">,&quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;num_cpus: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">num_cpus</span><span class="si">}</span><span class="s2">, create_network: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">create_network</span><span class="si">}</span><span class="s2">, version&quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">run_container</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span>
                                             <span class="n">num_cpus</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">num_cpus</span><span class="p">,</span> <span class="n">create_network</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">create_network</span><span class="p">,</span>
                                             <span class="n">version</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopContainersOfExecution"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopContainersOfExecution">[docs]</a>    <span class="k">def</span> <span class="nf">stopContainersOfExecution</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopContainersOfExecutionMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the containers of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stops containers &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">start_containers_of_execution</span><span class="p">(</span><span class="n">emulation_execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                                                             <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startHostManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startHostManager">[docs]</a>    <span class="k">def</span> <span class="nf">startHostManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartHostManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts a specific host manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting host manager with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> in  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">start_host_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                              <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> not found in execution &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> of emulation </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopHostManagers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopHostManagers">[docs]</a>    <span class="k">def</span> <span class="nf">stopHostManagers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopHostManagersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the host managers of a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping host managers in  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">stop_host_managers</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                          <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopHostManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopHostManager">[docs]</a>    <span class="k">def</span> <span class="nf">stopHostManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopHostManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops a specific host manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping host manager with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> in  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">stop_host_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                             <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startHostMonitorThreads"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startHostMonitorThreads">[docs]</a>    <span class="k">def</span> <span class="nf">startHostMonitorThreads</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartHostMonitorThreadsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the host monitor threads of a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting host monitor threads  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">start_host_monitor_threads</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                  <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                  <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopFilebeats"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopFilebeats">[docs]</a>    <span class="k">def</span> <span class="nf">stopFilebeats</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopFilebeatsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops filebeats in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping filebeats  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">stop_filebeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                      <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                      <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopPacketbeats"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopPacketbeats">[docs]</a>    <span class="k">def</span> <span class="nf">stopPacketbeats</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopPacketbeatsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops packetbeats in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping packetbeats  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">stop_packetbeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                        <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                        <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopMetricbeats"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopMetricbeats">[docs]</a>    <span class="k">def</span> <span class="nf">stopMetricbeats</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopMetricbeatsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops Metricbeats in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping metricbeats  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">stop_metricbeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                        <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                        <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopHeartbeats"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopHeartbeats">[docs]</a>    <span class="k">def</span> <span class="nf">stopHeartbeats</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopHeartbeatsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops Heartbeats in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping heartbeats  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">stop_heartbeats</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                       <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                       <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startHostMonitorThread"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startHostMonitorThread">[docs]</a>    <span class="k">def</span> <span class="nf">startHostMonitorThread</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartHostMonitorThreadMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts a specific host monitor thread</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting host monitor thread on container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">start_host_monitor_thread</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                     <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                                                     <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startFilebeat"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startFilebeat">[docs]</a>    <span class="k">def</span> <span class="nf">startFilebeat</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartFileBeatMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts filebeat on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting filebeat on container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">, &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;initial start: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">start_filebeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                          <span class="n">ips</span><span class="o">=</span><span class="p">[</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">],</span>
                                          <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span> <span class="n">initial_start</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startPacketbeat"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startPacketbeat">[docs]</a>    <span class="k">def</span> <span class="nf">startPacketbeat</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartPacketBeatMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts packetbeat on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting packetbeat on container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">, &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;initialStart: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">start_packetbeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                            <span class="n">ips</span><span class="o">=</span><span class="p">[</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">],</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                                            <span class="n">initial_start</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startMetricbeat"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startMetricbeat">[docs]</a>    <span class="k">def</span> <span class="nf">startMetricbeat</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartMetricBeatMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts metricbeat on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting metricbeat on container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">, &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;initialStart: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">start_metricbeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                            <span class="n">ips</span><span class="o">=</span><span class="p">[</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">],</span>
                                            <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span> <span class="n">initial_start</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startHeartbeat"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startHeartbeat">[docs]</a>    <span class="k">def</span> <span class="nf">startHeartbeat</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartHeartBeatMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts heartbeat on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting heartbeat on container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">, &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;initialStart: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">start_heartbeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                           <span class="n">ips</span><span class="o">=</span><span class="p">[</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">],</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                                           <span class="n">initial_start</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">initialStart</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopFilebeat"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopFilebeat">[docs]</a>    <span class="k">def</span> <span class="nf">stopFilebeat</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopFileBeatMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops filebeat on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping filebeat on container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">stop_filebeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                         <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopPacketbeat"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopPacketbeat">[docs]</a>    <span class="k">def</span> <span class="nf">stopPacketbeat</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopPacketBeatMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops packetbeat on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping packetbeat on container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">stop_packetbeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                           <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopMetricbeat"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopMetricbeat">[docs]</a>    <span class="k">def</span> <span class="nf">stopMetricbeat</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopMetricBeatMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops metricbeat on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping metricbeat on container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">stop_metricbeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                           <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopHeartbeat"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopHeartbeat">[docs]</a>    <span class="k">def</span> <span class="nf">stopHeartbeat</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopHeartBeatMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops heartbeat on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping heartbeat on container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">stop_heartbeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                          <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.applyFileBeatConfig"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.applyFileBeatConfig">[docs]</a>    <span class="k">def</span> <span class="nf">applyFileBeatConfig</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ApplyFileBeatConfigMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the filebeat config on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying the filebeat config to container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">config_filebeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                           <span class="n">container</span><span class="o">=</span><span class="n">container_config</span><span class="p">,</span>
                                           <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.applyPacketBeatConfig"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.applyPacketBeatConfig">[docs]</a>    <span class="k">def</span> <span class="nf">applyPacketBeatConfig</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ApplyPacketBeatConfigMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the packetbeat config on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying the packetbeat config to container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">config_packetbeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                             <span class="n">container</span><span class="o">=</span><span class="n">container_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.applyMetricBeatConfig"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.applyMetricBeatConfig">[docs]</a>    <span class="k">def</span> <span class="nf">applyMetricBeatConfig</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ApplyMetricBeatConfigMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the metricbeat config on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying the metricbeat config to container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">container_config</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">config_metricbeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                             <span class="n">container</span><span class="o">=</span><span class="n">container_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.applyHeartBeatConfig"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.applyHeartBeatConfig">[docs]</a>    <span class="k">def</span> <span class="nf">applyHeartBeatConfig</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ApplyHeartBeatConfigMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the heartbeat config on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying the heartbeat config to container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">container_config</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">config_heartbeat</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                            <span class="n">container</span><span class="o">=</span><span class="n">container_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getHostMonitorThreadsStatuses"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getHostMonitorThreadsStatuses">[docs]</a>    <span class="k">def</span> <span class="nf">getHostMonitorThreadsStatuses</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetHostMonitorThreadsStatusesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">HostManagerStatusesDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the host monitor thread statuses of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a HostManagerStatusesDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the host monitor thread statuses &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">host_statuses_and_ips</span> <span class="o">=</span> \
                <span class="n">HostController</span><span class="o">.</span><span class="n">get_host_monitor_threads_statuses</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                                 <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                                 <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="n">host_statuses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_host_status_to_host_manager_status_dto</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                                     <span class="n">host_statuses_and_ips</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">HostManagerStatusesDTO</span><span class="p">(</span>
                <span class="n">hostManagerStatuses</span><span class="o">=</span><span class="n">host_statuses</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">HostManagerStatusesDTO</span><span class="p">(</span>
                <span class="n">hostManagerStatuses</span><span class="o">=</span><span class="p">[]</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getHostManagersInfo"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getHostManagersInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getHostManagersInfo</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetHostManagersInfoMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">HostManagersInfoDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the info of host managers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a HostManagersInfoDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the info of host managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">host_managers_dto</span> <span class="o">=</span> <span class="n">HostController</span><span class="o">.</span><span class="n">get_host_managers_info</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                <span class="n">active_ips</span><span class="o">=</span><span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_active_ips</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">),</span>
                <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_host_info_dto</span><span class="p">(</span><span class="n">host_managers_dto</span><span class="o">=</span><span class="n">host_managers_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_host_managers_info_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopKafkaManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopKafkaManager">[docs]</a>    <span class="k">def</span> <span class="nf">stopKafkaManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopKafkaManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the kafka manager in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the kafka manager  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">KafkaController</span><span class="o">.</span><span class="n">stop_kafka_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startKafkaManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startKafkaManager">[docs]</a>    <span class="k">def</span> <span class="nf">startKafkaManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartKafkaManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the kafka manager in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the kafka manager  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">KafkaController</span><span class="o">.</span><span class="n">start_kafka_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.createKafkaTopics"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.createKafkaTopics">[docs]</a>    <span class="k">def</span> <span class="nf">createKafkaTopics</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CreateKafkaTopicsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates the kafka topics in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Kafka topics  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">KafkaController</span><span class="o">.</span><span class="n">create_topics</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                          <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getKafkaStatus"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getKafkaStatus">[docs]</a>    <span class="k">def</span> <span class="nf">getKafkaStatus</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetKafkaManagerStatusMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">KafkaStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the Kafka status in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the Kafka status  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">kafka_dto</span> <span class="o">=</span> <span class="n">KafkaController</span><span class="o">.</span><span class="n">get_kafka_status</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_kafka_dto_to_kafka_status_dto</span><span class="p">(</span><span class="n">kafka_dto</span><span class="o">=</span><span class="n">kafka_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_kafka_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopKafkaServer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopKafkaServer">[docs]</a>    <span class="k">def</span> <span class="nf">stopKafkaServer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopKafkaServerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the kafka server in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping kafka server  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">KafkaController</span><span class="o">.</span><span class="n">stop_kafka_server</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                              <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startKafkaServer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startKafkaServer">[docs]</a>    <span class="k">def</span> <span class="nf">startKafkaServer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartKafkaServerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the kafka server in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting kafka server  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">KafkaController</span><span class="o">.</span><span class="n">start_kafka_server</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                               <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getKafkaManagersInfo"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getKafkaManagersInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getKafkaManagersInfo</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetKafkaManagersInfoMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">KafkaManagersInfoDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the info of kafka managers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a KafkaManagersInfoDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the info of kafka managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kafka_managers_info_dto</span> <span class="o">=</span> <span class="n">KafkaController</span><span class="o">.</span><span class="n">get_kafka_managers_info</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                <span class="n">active_ips</span><span class="o">=</span><span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_active_ips</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">),</span>
                <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_kafka_info_dto</span><span class="p">(</span><span class="n">kafka_managers_info_dto</span><span class="o">=</span><span class="n">kafka_managers_info_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_kafka_managers_info_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopOSSECIDSes"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopOSSECIDSes">[docs]</a>    <span class="k">def</span> <span class="nf">stopOSSECIDSes</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopOSSECIDSesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stop the OSSEC IDSes in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the OSSEC IDSes  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">stop_ossec_idses</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startOSSECIDSes"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startOSSECIDSes">[docs]</a>    <span class="k">def</span> <span class="nf">startOSSECIDSes</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartOSSECIDSesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starting the OSSEC IDSes in a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the OSSEC IDSes  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">start_ossec_idses</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                             <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                             <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopOSSECIDS"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopOSSECIDS">[docs]</a>    <span class="k">def</span> <span class="nf">stopOSSECIDS</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopOSSECIDSMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the OSSEC IDS on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stops the OSSEC IDS on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">stop_ossec_ids</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                              <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startOSSECIDS"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startOSSECIDS">[docs]</a>    <span class="k">def</span> <span class="nf">startOSSECIDS</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartOSSECIDSMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the OSSEC IDS on a specific host</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the OSSEC IDS on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">start_ossec_ids</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                               <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startOSSECIDSManagers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startOSSECIDSManagers">[docs]</a>    <span class="k">def</span> <span class="nf">startOSSECIDSManagers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartOSSECIDSManagers</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the OSSEC IDS managers for a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the OSSEC IDS maangers &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">start_ossec_idses_managers</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                      <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopOSSECIDSManagers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopOSSECIDSManagers">[docs]</a>    <span class="k">def</span> <span class="nf">stopOSSECIDSManagers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopOSSECIDSManagers</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the OSSEC IDS managers for a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the OSSEC IDS managers &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">stop_ossec_idses_managers</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                     <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startOSSECIDSManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startOSSECIDSManager">[docs]</a>    <span class="k">def</span> <span class="nf">startOSSECIDSManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartOSSECIDSManager</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the OSSEC IDS manager on a specific node</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starts the OSSEC IDS manager on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">start_ossec_ids_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                       <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopOSSECIDSManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopOSSECIDSManager">[docs]</a>    <span class="k">def</span> <span class="nf">stopOSSECIDSManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopOSSECIDSManager</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the OSSEC IDS manager on a specific node</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the OSSEC IDS manager on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">stop_ossec_ids_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                      <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startOSSECIDSMonitorThread"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startOSSECIDSMonitorThread">[docs]</a>    <span class="k">def</span> <span class="nf">startOSSECIDSMonitorThread</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartOSSECIDSMonitorThreadMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the OSSEC IDS monitor thread on a specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the OSSEC IDS monitor thread on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">start_ossec_ids_monitor_thread</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                              <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopOSSECIDSMonitorThread"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopOSSECIDSMonitorThread">[docs]</a>    <span class="k">def</span> <span class="nf">stopOSSECIDSMonitorThread</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopOSSECIDSMonitorThreadMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the OSSEC IDS monitor thread on a specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the OSSEC IDS monitor thread on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">stop_ossec_ids_monitor_thread</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                             <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopOSSECIDSMonitorThreads"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopOSSECIDSMonitorThreads">[docs]</a>    <span class="k">def</span> <span class="nf">stopOSSECIDSMonitorThreads</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopOSSECIDSMonitorThreadsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the OSSEC IDS monitor threads for a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the OSSEC IDS monitor threads &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">stop_ossec_idses_monitor_threads</span><span class="p">(</span>
            <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getOSSECIDSMonitorThreadStatuses"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getOSSECIDSMonitorThreadStatuses">[docs]</a>    <span class="k">def</span> <span class="nf">getOSSECIDSMonitorThreadStatuses</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetOSSECIDSMonitorThreadStatusesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OSSECIdsMonitorThreadStatusesDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the OSSEC IDS monitor thread statuses for a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OSSECIdsMonitorThreadStatusesDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the OSSEC IDS monitor thread statuses &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">status_dtos</span> <span class="o">=</span> <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">get_ossec_idses_monitor_threads_statuses</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
            <span class="n">status_dtos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_ossec_ids_monitor_dto_to_ossec_ids_status_dto</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                    <span class="n">status_dtos</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OSSECIdsMonitorThreadStatusesDTO</span><span class="p">(</span>
                <span class="n">ossecIDSStatuses</span><span class="o">=</span><span class="n">status_dtos</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OSSECIdsMonitorThreadStatusesDTO</span><span class="p">(</span>
                <span class="n">ossecIDSStatuses</span><span class="o">=</span><span class="p">[]</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getOSSECIdsManagersInfo"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getOSSECIdsManagersInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getOSSECIdsManagersInfo</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetOSSECIDSManagersInfoMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OSSECIdsManagersInfoDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the info of OSSEC IDS managers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a OSSECIdsManagersInfoDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the info of OSSEC IDS managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ossec_ids_managers_info_dto</span> <span class="o">=</span> <span class="n">OSSECIDSController</span><span class="o">.</span><span class="n">get_ossec_managers_info</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                <span class="n">active_ips</span><span class="o">=</span><span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_active_ips</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">),</span>
                <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_ossec_info_dto</span><span class="p">(</span><span class="n">ossec_ids_managers_info_dto</span><span class="o">=</span><span class="n">ossec_ids_managers_info_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_ossec_managers_info_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startRyuManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startRyuManager">[docs]</a>    <span class="k">def</span> <span class="nf">startRyuManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartRyuManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Ryu manager for a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the Ryu manager &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">SDNControllerManager</span><span class="o">.</span><span class="n">start_ryu_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                   <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopRyuManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopRyuManager">[docs]</a>    <span class="k">def</span> <span class="nf">stopRyuManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopRyuManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Ryu manager for a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Ryu manager &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">SDNControllerManager</span><span class="o">.</span><span class="n">stop_ryu_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                  <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getRyuStatus"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getRyuStatus">[docs]</a>    <span class="k">def</span> <span class="nf">getRyuStatus</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetRyuServiceStatusMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RyuManagerStatusDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the Ryu status</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a RyuManagerStatusDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the Ryu status &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> \
                <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">status_dto</span> <span class="o">=</span> <span class="n">SDNControllerManager</span><span class="o">.</span><span class="n">get_ryu_status</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                             <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_ryu_dto_to_ryu_status_dto</span><span class="p">(</span><span class="n">status_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_ryu_manager_status_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startRyu"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startRyu">[docs]</a>    <span class="k">def</span> <span class="nf">startRyu</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartRyuServiceMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts Ryu</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting Ryu &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> \
                <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">SDNControllerManager</span><span class="o">.</span><span class="n">start_ryu</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                           <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopRyu"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopRyu">[docs]</a>    <span class="k">def</span> <span class="nf">stopRyu</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopRyuServiceMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops Ryu</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping Ryu &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">SDNControllerManager</span><span class="o">.</span><span class="n">stop_ryu</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                          <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getRyuManagersInfo"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getRyuManagersInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getRyuManagersInfo</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetRyuManagersInfoMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RyuManagersInfoDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the info of Ryu managers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a RyuManagersInfoDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the info of Ryu managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ryu_managers_info_dto</span> <span class="o">=</span> <span class="n">SDNControllerManager</span><span class="o">.</span><span class="n">get_ryu_managers_info</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                <span class="n">active_ips</span><span class="o">=</span><span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_active_ips</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">),</span>
                <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_ryu_info_dto</span><span class="p">(</span><span class="n">ryu_managers_info_dto</span><span class="o">=</span><span class="n">ryu_managers_info_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_ryu_managers_info_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopSnortIdses"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopSnortIdses">[docs]</a>    <span class="k">def</span> <span class="nf">stopSnortIdses</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopSnortIdsesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Snort IDSes for a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Snort IDSes &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">stop_snort_idses</span><span class="p">(</span>
            <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
            <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getSnortIdsMonitorThreadStatuses"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getSnortIdsMonitorThreadStatuses">[docs]</a>    <span class="k">def</span> <span class="nf">getSnortIdsMonitorThreadStatuses</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetSnortIdsMonitorThreadStatusesMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">SnortIdsMonitorThreadStatusesDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the Snort IDS monitor thread statuses for a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an SnortIdsMonitorThreadStatusesDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the Snort IDS monitor thread statuses &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">status_dtos</span> <span class="o">=</span> <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">get_snort_idses_monitor_threads_statuses</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="n">status_dtos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_snort_ids_monitor_dto_to_snort_ids_status_dto</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                    <span class="n">status_dtos</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">SnortIdsMonitorThreadStatusesDTO</span><span class="p">(</span>
                <span class="n">snortIDSStatuses</span><span class="o">=</span><span class="n">status_dtos</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">SnortIdsMonitorThreadStatusesDTO</span><span class="p">(</span>
                <span class="n">snortIDSStatuses</span><span class="o">=</span><span class="p">[])</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopSnortIdsesMonitorThreads"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopSnortIdsesMonitorThreads">[docs]</a>    <span class="k">def</span> <span class="nf">stopSnortIdsesMonitorThreads</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopSnortIdsesMonitorThreadsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Snort IDSes monitor threads for a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Snort IDSes monitor threads  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">stop_snort_idses_monitor_threads</span><span class="p">(</span>
            <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
            <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopSnortIds"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopSnortIds">[docs]</a>    <span class="k">def</span> <span class="nf">stopSnortIds</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopSnortMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Snort IDS on a specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Snort IDS on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">stop_snort_ids</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                              <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                                              <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopSnortIdsMonitorThread"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopSnortIdsMonitorThread">[docs]</a>    <span class="k">def</span> <span class="nf">stopSnortIdsMonitorThread</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopSnortIdsMonitorThreadMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Snort IDS Monitor Thread on a specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Snort IDS monitor thread on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">stop_snort_idses_monitor_thread</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                               <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                                                               <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSnortIds"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSnortIds">[docs]</a>    <span class="k">def</span> <span class="nf">startSnortIds</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSnortMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Snort IDS on a specific container in a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the Snort IDS on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">start_snort_ids</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                               <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                                               <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSnortIdsMonitorThread"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSnortIdsMonitorThread">[docs]</a>    <span class="k">def</span> <span class="nf">startSnortIdsMonitorThread</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSnortIdsMonitorThreadMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Snort IDS monitor thread on a specific container in a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the Snort IDS monitor thread on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">start_snort_idses_monitor_thread</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                                <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                                                                <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSnortIdsMonitorThreads"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSnortIdsMonitorThreads">[docs]</a>    <span class="k">def</span> <span class="nf">startSnortIdsMonitorThreads</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSnortIdsMonitorThreadsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Snort IDS monitor threads of a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the Snort IDS monitor threads &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">start_snort_idses_monitor_threads</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                             <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                             <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSnortIdsManagers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSnortIdsManagers">[docs]</a>    <span class="k">def</span> <span class="nf">startSnortIdsManagers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSnortIdsManagersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Snort IDS managers of a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the Snort IDS managers &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">start_snort_managers</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopSnortIdsManagers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopSnortIdsManagers">[docs]</a>    <span class="k">def</span> <span class="nf">stopSnortIdsManagers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopSnortIdsManagersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Snort IDS managers of a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Snort IDS managers &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">stop_snort_managers</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                               <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                               <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSnortIdsManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSnortIdsManager">[docs]</a>    <span class="k">def</span> <span class="nf">startSnortIdsManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSnortIdsManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Snort IDS manager at a specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the Snort IDS manager on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">container_config</span><span class="p">)</span>
            <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">start_snort_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                   <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                                                   <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopSnortIdsManager"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopSnortIdsManager">[docs]</a>    <span class="k">def</span> <span class="nf">stopSnortIdsManager</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopSnortIdsManagerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Snort IDS manager at a specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Snort IDS manager on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">stop_snort_manager</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                  <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                                                  <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopSnortIdsMonitorThreads"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopSnortIdsMonitorThreads">[docs]</a>    <span class="k">def</span> <span class="nf">stopSnortIdsMonitorThreads</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopSnortIdsMonitorThreadsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Snort IDS managers of a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Snort IDS monitor threads &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">stop_snort_idses_monitor_threads</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                            <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                            <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getSnortIdsManagersInfo"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getSnortIdsManagersInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getSnortIdsManagersInfo</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetSnortIdsManagersInfoMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">SnortIdsManagersInfoDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the info of Snort IDS managers</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a SnortIdsManagersInfoDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the info of Snort IDS managers in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">snort_ids_managers_info_dto</span> <span class="o">=</span> <span class="n">SnortIDSController</span><span class="o">.</span><span class="n">get_snort_managers_info</span><span class="p">(</span>
                <span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span>
                <span class="n">active_ips</span><span class="o">=</span><span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_active_ips</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">),</span>
                <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_snort_info_dto</span><span class="p">(</span><span class="n">snort_ids_managers_info_dto</span><span class="o">=</span><span class="n">snort_ids_managers_info_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_snort_managers_info_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getExecutionInfo"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getExecutionInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getExecutionInfo</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetExecutionInfoMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ExecutionInfoDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the info of a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an ExecutionInfoDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the info of the execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">execution_info_dto</span> <span class="o">=</span> <span class="n">EmulationEnvController</span><span class="o">.</span><span class="n">get_execution_info</span><span class="p">(</span>
                <span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(),</span> <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_execution_info_dto</span><span class="p">(</span><span class="n">execution_info_dto</span><span class="o">=</span><span class="n">execution_info_dto</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_execution_info_dto</span><span class="p">()</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.listKibanaTunnels"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.listKibanaTunnels">[docs]</a>    <span class="k">def</span> <span class="nf">listKibanaTunnels</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ListKibanaTunnelsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">KibanaTunnelsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the Kibana tunnels</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an KibanaTunnelsDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the Kibana tunnels&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">create_kibana_tunnels_dto_from_dict</span><span class="p">(</span>
            <span class="nb">dict</span><span class="o">=</span><span class="n">cluster_constants</span><span class="o">.</span><span class="n">KIBANA_TUNNELS</span><span class="o">.</span><span class="n">KIBANA_TUNNELS_DICT</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.listRyuTunnels"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.listRyuTunnels">[docs]</a>    <span class="k">def</span> <span class="nf">listRyuTunnels</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">ListRyuTunnelsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RyuTunnelsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the Ryu tunnels</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a RyuTunnelsDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the Ryu tunnels&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">create_ryu_tunnels_dto_from_dict</span><span class="p">(</span><span class="nb">dict</span><span class="o">=</span><span class="n">cluster_constants</span><span class="o">.</span><span class="n">RYU_TUNNELS</span><span class="o">.</span><span class="n">RYU_TUNNELS_DICT</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.createKibanaTunnel"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.createKibanaTunnel">[docs]</a>    <span class="k">def</span> <span class="nf">createKibanaTunnel</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CreateKibanaTunnelMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new Kibana tunnel</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating a Kibana tunnel for emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">, &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;execution id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">create_kibana_tunnel</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.createRyuTunnel"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.createRyuTunnel">[docs]</a>    <span class="k">def</span> <span class="nf">createRyuTunnel</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CreateRyuTunnelMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new Ryu tunnel</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating a Ryu tunnel for emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">, &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;execution id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">create_ryu_tunnel</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.removeRyuTunnel"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.removeRyuTunnel">[docs]</a>    <span class="k">def</span> <span class="nf">removeRyuTunnel</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RemoveRyuTunnelMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes a Ryu tunnel</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Remove the Ryu tunnel for emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">, &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;execution id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">remove_ryu_tunnel</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.removeKibanaTunnel"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.removeKibanaTunnel">[docs]</a>    <span class="k">def</span> <span class="nf">removeKibanaTunnel</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">RemoveKibanaTunnelMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes a Kibana tunnel</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Remove the Kibana tunnel for emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">, &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;execution id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">remove_kibana_tunnel</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopHostMonitorThreads"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopHostMonitorThreads">[docs]</a>    <span class="k">def</span> <span class="nf">stopHostMonitorThreads</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopHostMonitorThreadsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the host monitor threads of a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping host monitor threads  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">stop_host_monitor_threads</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                 <span class="n">physical_host_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                 <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopHostMonitorThread"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopHostMonitorThread">[docs]</a>    <span class="k">def</span> <span class="nf">stopHostMonitorThread</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopHostMonitorThreadMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops a specific host monitor thread</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping host monitor thread on container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">stop_host_monitor_thread</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                    <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                                                    <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startRyuMonitor"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startRyuMonitor">[docs]</a>    <span class="k">def</span> <span class="nf">startRyuMonitor</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartRyuMonitorThreadMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Ryu monitor thread for a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the Ryu monitor thread &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">SDNControllerManager</span><span class="o">.</span><span class="n">start_ryu_monitor</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                   <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                                   <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopRyuMonitor"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopRyuMonitor">[docs]</a>    <span class="k">def</span> <span class="nf">stopRyuMonitor</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopRyuMonitorThreadMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Ryu monitor thread for a given execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Ryu monitor thread &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">SDNControllerManager</span><span class="o">.</span><span class="n">stop_ryu_monitor</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                  <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getRyuManagerLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getRyuManagerLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getRyuManagerLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetRyuManagerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific Ryu manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the Ryu manager &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="ow">or</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> \
                <span class="o">!=</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">ryu_constants</span><span class="o">.</span><span class="n">RYU</span><span class="o">.</span><span class="n">LOG_FILE</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span>
                <span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getRyuControllerLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getRyuControllerLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getRyuControllerLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetRyuControllerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific Ryu controller</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the Ryu controller &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="ow">or</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> \
                <span class="o">!=</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">manager_log_dir</span> <span class="o">+</span>
                    <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">manager_log_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span>
                <span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">sdn_controller_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getElkLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getElkLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getElkLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetElkLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific ELK stack</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the ELK stack &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">!=</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">collector_constants</span><span class="o">.</span><span class="n">ELK</span><span class="o">.</span><span class="n">ELK_LOG</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span>
                <span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getElkManagerLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getElkManagerLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getElkManagerLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetElkManagerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific  ELK manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the ELK manager &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">!=</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">elk_manager_log_dir</span> <span class="o">+</span>
                    <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">elk_manager_log_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span>
                <span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">elk_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getTrafficManagerLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getTrafficManagerLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getTrafficManagerLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetTrafficManagerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific traffic manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the traffic manager with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">get_node_traffic_config_by_ip</span><span class="p">(</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span><span class="o">.</span><span class="n">traffic_manager_log_dir</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">get_node_traffic_config_by_ip</span><span class="p">(</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span><span class="o">.</span><span class="n">traffic_manager_log_file</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span>
                <span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getHostManagerLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getHostManagerLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getHostManagerLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetHostManagerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific host manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the host manager with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">host_manager_config</span><span class="o">.</span><span class="n">host_manager_log_dir</span> <span class="o">+</span>
                    <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">host_manager_config</span><span class="o">.</span><span class="n">host_manager_log_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span>
                <span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getOSSECIdsLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getOSSECIdsLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getOSSECIdsLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetOSSECIdsLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific OSSEC IDS</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the OSSEC IDS with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">collector_constants</span><span class="o">.</span><span class="n">OSSEC</span><span class="o">.</span><span class="n">OSSEC_LOG_FILE</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                                               <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getOSSECIdsManagerLogsMsg"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getOSSECIdsManagerLogsMsg">[docs]</a>    <span class="k">def</span> <span class="nf">getOSSECIdsManagerLogsMsg</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetOSSECIdsManagerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific OSSEC IDS manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the OSSEC IDS manager with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">ossec_ids_manager_config</span><span class="o">.</span><span class="n">ossec_ids_manager_log_dir</span> <span class="o">+</span>
                    <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">ossec_ids_manager_config</span><span class="o">.</span><span class="n">ossec_ids_manager_log_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                                               <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getSnortIdsLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getSnortIdsLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getSnortIdsLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetSnortIdsLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific Snort IDS</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the Snort IDS with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">collector_constants</span><span class="o">.</span><span class="n">SNORT_IDS_ROUTER</span><span class="o">.</span><span class="n">SNORT_FAST_LOG_FILE</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getSnortIdsManagerLogsMsg"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getSnortIdsManagerLogsMsg">[docs]</a>    <span class="k">def</span> <span class="nf">getSnortIdsManagerLogsMsg</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetSnortIdsManagerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific Snort IDS manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the Snort IDS manager with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">snort_ids_manager_config</span><span class="o">.</span><span class="n">snort_ids_manager_log_dir</span> <span class="o">+</span>
                    <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">snort_ids_manager_config</span><span class="o">.</span><span class="n">snort_ids_manager_log_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getKafkaLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getKafkaLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getKafkaLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetKafkaLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific Kafka server</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the Kafka server &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">!=</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">collector_constants</span><span class="o">.</span><span class="n">LOG_FILES</span><span class="o">.</span><span class="n">KAFKA_LOG_FILE</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span>
                <span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getKafkaManagerLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getKafkaManagerLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getKafkaManagerLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetKafkaManagerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific Kafka manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the Kafka manager &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">!=</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">kafka_manager_log_dir</span> <span class="o">+</span>
                    <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">kafka_manager_log_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span>
                <span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getClientManagerLogsMsg"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getClientManagerLogsMsg">[docs]</a>    <span class="k">def</span> <span class="nf">getClientManagerLogsMsg</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetClientManagerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific Client manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the Client manager &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">client_population_config</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">!=</span> \
                <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">client_population_config</span><span class="o">.</span><span class="n">client_manager_log_dir</span> <span class="o">+</span>
                    <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">client_population_config</span><span class="o">.</span><span class="n">client_manager_log_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_logs</span><span class="p">(</span>
                <span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">traffic_config</span><span class="o">.</span><span class="n">client_population_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getContainerLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getContainerLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getContainerLogs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetContainerLogsMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of a specific container</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a LogsDTO with the logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the logs of the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2"> &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">CONTAINER_LOGS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">container_config</span><span class="o">.</span><span class="n">full_name_str</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="p">(</span><span class="n">output_bytes</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
            <span class="n">output_str</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">output_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">output</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getClusterManagerLogs"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getClusterManagerLogs">[docs]</a>    <span class="k">def</span> <span class="nf">getClusterManagerLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetClusterManagerLogsMsg</span><span class="p">,</span>
                              <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the logs of the cluster manager</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting the cluster manager logs&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get_current_config</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">cluster_manager_log_file</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">logs</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception reading log file: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">. Stacktrace: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">LogsDTO</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.getExecutionTimeSeriesData"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.getExecutionTimeSeriesData">[docs]</a>    <span class="k">def</span> <span class="nf">getExecutionTimeSeriesData</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">GetExecutionTimeSeriesDataMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">EmulationMetricsTimeSeriesDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets time-series data of an emulation execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: a DTO with logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting the time-series data of &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">, &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;minutes: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">minutes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> \
                <span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="o">.</span><span class="n">kafka_config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">!=</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_empty_emulation_metrics_time_series_dto</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="n">time_series</span> <span class="o">=</span> <span class="n">ReadEmulationStatisticsUtil</span><span class="o">.</span><span class="n">read_all</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                                               <span class="n">time_window_minutes</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">minutes</span><span class="p">,</span>
                                                               <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">convert_emulation_metrics_time_series_dto</span><span class="p">(</span><span class="n">time_series_dto</span><span class="o">=</span><span class="n">time_series</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSparkServer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSparkServer">[docs]</a>    <span class="k">def</span> <span class="nf">startSparkServer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSparkServerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Spark server on a specific container in a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the Spark server on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">container_config</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">start_spark</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                       <span class="n">ips</span><span class="o">=</span><span class="p">[</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">],</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopSparkServer"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopSparkServer">[docs]</a>    <span class="k">def</span> <span class="nf">stopSparkServer</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopSparkServerMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Spark server on a specific container in a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Spark server on the container with ip: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="si">}</span><span class="s2">  &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">container_config</span> <span class="o">=</span> <span class="n">ClusterManagerUtil</span><span class="o">.</span><span class="n">get_container_config</span><span class="p">(</span><span class="n">execution</span><span class="o">=</span><span class="n">execution</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">containerIp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">container_config</span><span class="o">.</span><span class="n">physical_host_ip</span> <span class="o">==</span> <span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">():</span>
            <span class="n">HostController</span><span class="o">.</span><span class="n">stop_spark</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                      <span class="n">ips</span><span class="o">=</span><span class="p">[</span><span class="n">container_config</span><span class="o">.</span><span class="n">docker_gw_bridge_ip</span><span class="p">],</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.startSparkServers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.startSparkServers">[docs]</a>    <span class="k">def</span> <span class="nf">startSparkServers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StartSparkServersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the Spark servers in a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting the Spark servers &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">start_sparks</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                    <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span>
                                    <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopSparkServers"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopSparkServers">[docs]</a>    <span class="k">def</span> <span class="nf">stopSparkServers</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopSparkServersMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the Spark servers in a specific execution</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping the Spark servers &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;in execution with id: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="si">}</span><span class="s2"> and emulation: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="n">MetastoreFacade</span><span class="o">.</span><span class="n">get_emulation_execution</span><span class="p">(</span><span class="n">ip_first_octet</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">ipFirstOctet</span><span class="p">,</span>
                                                            <span class="n">emulation_name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">emulation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">execution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">HostController</span><span class="o">.</span><span class="n">stop_sparks</span><span class="p">(</span><span class="n">emulation_env_config</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">emulation_env_config</span><span class="p">,</span>
                                   <span class="n">physical_server_ip</span><span class="o">=</span><span class="n">GeneralUtil</span><span class="o">.</span><span class="n">get_host_ip</span><span class="p">(),</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.checkPid"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.checkPid">[docs]</a>    <span class="k">def</span> <span class="nf">checkPid</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">CheckPidMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks the status of a PID</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking the status of PID: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">running</span> <span class="o">=</span> <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">is_pid_running</span><span class="p">(</span><span class="n">pid</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is PID </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2"> running? </span><span class="si">{</span><span class="n">running</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="n">running</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClusterManagerServicer.stopPid"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.ClusterManagerServicer.stopPid">[docs]</a>    <span class="k">def</span> <span class="nf">stopPid</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">StopPidMsg</span><span class="p">,</span>
            <span class="n">context</span><span class="p">:</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ServicerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops a PID</span>

<span class="sd">        :param request: the gRPC request</span>
<span class="sd">        :param context: the gRPC context</span>
<span class="sd">        :return: an OperationOutcomeDTO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping PID: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ManagementSystemController</span><span class="o">.</span><span class="n">stop_pid</span><span class="p">(</span><span class="n">pid</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2</span><span class="o">.</span><span class="n">OperationOutcomeDTO</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="serve"><a class="viewcode-back" href="../../../csle_cluster.cluster_manager.html#csle_cluster.cluster_manager.cluster_manager.serve">[docs]</a><span class="k">def</span> <span class="nf">serve</span><span class="p">(</span><span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50041</span><span class="p">,</span> <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;/var/log/csle/&quot;</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
          <span class="n">log_file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cluster_manager.log&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Starts the gRPC server for managing the cluster node</span>

<span class="sd">    :param port: the port that the server will listen to</span>
<span class="sd">    :param log_dir: the directory to write the log file</span>
<span class="sd">    :param log_file_name: the file name of the log</span>
<span class="sd">    :param max_workers: the maximum number of parallel gRPC workers</span>
<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">collector_constants</span><span class="o">.</span><span class="n">LOG_FILES</span><span class="o">.</span><span class="n">CLUSTER_MANAGER_LOG_DIR</span> <span class="o">=</span> <span class="n">log_dir</span>
    <span class="n">collector_constants</span><span class="o">.</span><span class="n">LOG_FILES</span><span class="o">.</span><span class="n">CLUSTER_MANAGER_LOG_FILE</span> <span class="o">=</span> <span class="n">log_file_name</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">grpc</span><span class="o">.</span><span class="n">server</span><span class="p">(</span><span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">))</span>
    <span class="n">csle_cluster</span><span class="o">.</span><span class="n">cluster_manager</span><span class="o">.</span><span class="n">cluster_manager_pb2_grpc</span><span class="o">.</span><span class="n">add_ClusterManagerServicer_to_server</span><span class="p">(</span>
        <span class="n">ClusterManagerServicer</span><span class="p">(),</span> <span class="n">server</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">add_insecure_port</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[::]:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;paramiko&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ClusterManager Server Started, Listening on port: </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">wait_for_termination</span><span class="p">()</span></div>


<span class="c1"># Program entrypoint</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">serve</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2025, Kim Hammar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>